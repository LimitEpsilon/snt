\usepackage{geometry}
\geometry{
  a4paper,
  total={170mm,257mm},
  left=20mm,
  top=20mm,
}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{kotex}
\usepackage{csquotes}
\usepackage{tabularray}
\usepackage{relsize}
\usepackage{hyperref}

%%% Math settings
\usepackage{amssymb,amsmath,amsthm,mathtools}
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{example}{Example}[section]
\newtheorem{lem}{Lemma}[section]
\newtheorem{thm}{Theorem}[section]
\newtheorem{cor}{Corollary}[section]
\newtheorem{clm}{Claim}[section]

%%% PL constructs
\usepackage{galois}
\usepackage{ebproofx}
\ebproofxset{center=false}

%%% Custom commands
\newcommand*{\vbar}{|}
\newcommand*{\lBrack}{⟦}
\newcommand*{\rBrack}{⟧}
\newcommand*{\finto}{\xrightarrow{\text{\textrm{fin}}}}
\newcommand*{\istype}{\mathrel{⩴}}
\newcommand*{\ortype}{\mathrel{|}}
\newcommand*{\cons}{::}
\newcommand*{\pset}{\mathcal{P}}
\newcommand*{\closeloc}[2]{\prescript{\backslash{#1}}{}{#2}}
\newcommand*{\openloc}[2]{{#2}^{#1}}

\def\ovbarw{1.2mu}
\def\ovbarh{1}
\newcommand*{\ovbar}[1]{\mkern \ovbarw\overline{\mkern-\ovbarw{\smash{#1}\scalebox{1}[\ovbarh]{\vphantom{i}}}\mkern-\ovbarw}\mkern \ovbarw}
\newcommand*{\A}[1]{\overset{\,_{\mbox{\Large .}}}{#1}}
\newcommand*{\Abs}[1]{{#1}^{\#}}
\newcommand*{\Expr}{\text{Expr}}
\newcommand*{\ExprVar}{\text{Var}}
\newcommand*{\Module}{\text{Module}}
\newcommand*{\ModVar}{\text{ModVar}}
\newcommand*{\modid}{d}
\newcommand*{\Time}{\mathbb{T}}
\newcommand*{\ATime}{\A{\Time}}
\newcommand*{\Ctx}{\text{Env}}
\newcommand*{\Mtx}{\text{MEnv}}
\newcommand*{\ctx}{\sigma}
\newcommand*{\Value}{\text{Val}}
\newcommand*{\Malue}{\text{MVal}}
\newcommand*{\Walue}{\text{WVal}}
\newcommand*{\Mem}{\text{Mem}}
\newcommand*{\Heap}{\text{Heap}}
\newcommand*{\Loc}{\text{Loc}}
\newcommand*{\FLoc}{\text{FLoc}}
\newcommand*{\Left}{\text{Left}}
\newcommand*{\Right}{\text{Right}}
\newcommand*{\Sig}{\text{Sig}}
\newcommand*{\mem}{m}
\newcommand*{\heap}{H}
\newcommand*{\dom}{\text{dom}}
\newcommand*{\AMem}{\A{\text{Heap}}}
\newcommand*{\State}{\text{State}}
\newcommand*{\AState}{\A{\text{State}}}
\newcommand*{\Result}{\text{Result}}
\newcommand*{\AResult}{\A{\text{Result}}}
\newcommand*{\Tick}{\text{Tick}}
\newcommand*{\lfp}{\text{lfp}}
\newcommand*{\Step}{\text{Step}}
\newcommand*{\step}{\text{step}}
\newcommand*{\semarrow}{\Downarrow}
\newcommand*{\asemarrow}{\A{\rightsquigarrow}}
\newcommand*{\synlink}{\rtimes}
\newcommand*{\semlink}{\mathbin{\text{\rotatebox[origin=c]{180}{$\propto$}}}}
\newcommand*{\mt}{\mathsf{empty}}
\newcommand*{\valid}{\mathsf{valid}}
\newcommand*{\Path}{\text{Path}}
\newcommand*{\equivalent}{\sim}
\newcommand*{\tystate}{t}

\newcommand*{\doubleplus}{\ensuremath{\mathbin{+\mkern-3mu+}}}
\newcommand*{\project}{\text{\texttt{:>} }}
\newcommand*{\Exp}{\mathsf{Exp}}
\newcommand*{\Imp}{\mathsf{Imp}}
\newcommand*{\Fin}{\mathsf{Fin}}
\newcommand*{\Link}{\text{Link}}
\newcommand*{\link}{\text{link}}
\newcommand*{\sembracket}[1]{\lBrack{#1}\rBrack}
\newcommand*{\fin}[2]{{#1}\xrightarrow{\mbox{\tiny{fin}}}{#2}}
\newcommand*{\addr}{\mathsf{addr}}
\newcommand*{\tick}{\mathsf{tick}}
\newcommand*{\modctx}{\mathsf{ctx}}
\newcommand*{\mapinject}[2]{{#2}[{#1}]}
\newcommand*{\inject}[2]{{#2}\langle{#1}\rangle}
\newcommand*{\deletepre}[2]{{#2}\overline{\doubleplus}{#1}}
\newcommand*{\deletemap}[2]{{#1}\overline{[{#2}]}}
\newcommand*{\delete}[2]{{#2}{\langle{#1}\rangle}^{-1}}
\newcommand*{\filter}{\mathsf{filter}}
\newcommand*{\Lete}{\mathtt{val}}
\newcommand*{\Letm}{\mathtt{mod}}
\newcommand*{\textand}{\text{ and }}
\newcommand*{\eval}{\text{eval}}

% symbol standing for partial proof tree
\newcommand*{\ptree}{t}

% labelled expressions {p:e}
\newcommand*{\plabel}[2]{\{{#1}:{#2}\}}

% labelled locations \ell^p
\newcommand*{\llabel}[2]{{#2}^{#1}}

% big-step evaluation judgment σ ⊢ e ⇓ v
\newcommand*{\evjudg}[3]{{#1}\vdash{#2}\Downarrow{#3}}

% typing judgment Γ ⊢ e : τ, S
\newcommand*{\typejudg}[4]{{#1}\vdash{#2}:{#3},{#4}}

% semantic typing judgment Γ ⊨ e : τ, S
\newcommand*{\semtypejudg}[4]{{#1}\vDash{#2}:{#3},{#4}}

\newcommand*{\arrowty}[3]{{#1}\xrightarrow{\mbox{\tiny$#2$}}{#3}}
\newcommand*{\ValRel}[1]{\mathcal{V}\sembracket{#1}}
\newcommand*{\WalRel}[1]{\mathcal{W}\sembracket{#1}}
\newcommand*{\ExprRel}[1]{\mathcal{X}\sembracket{#1}}
\newcommand*{\CtxRel}[1]{\mathcal{C}\sembracket{#1}}
\newcommand*{\EvtRel}[1]{\mathcal{\event}\sembracket{#1}}
\newcommand*{\ModRel}[1]{\mathcal{M}\sembracket{#1}}
\newcommand*{\TyEnv}{\text{TyEnv}}
\newcommand*{\TyVar}{\text{TyVar}}
\newcommand*{\Type}{\text{Type}}
\newcommand*{\Subst}{\text{Subst}}
\newcommand*{\external}{\Gamma_0}
\newcommand*{\Safe}{S}
\newcommand*{\unsafe}{\text{unsafe}}

\newcommand*{\event}{E}
\newcommand*{\Event}{\text{Event}}
\newcommand*{\InitE}{\textsf{Init}}
\newcommand*{\ReadE}{\textsf{Read}}
\newcommand*{\CallE}{\textsf{Call}}
\newcommand*{\resolve}{\downarrow_{\ctx_0}}
\newcommand*{\cstr}{c}
\newcommand*{\Cstr}{C}
\newcommand*{\constraints}{\mathbb{C}}
